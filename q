[1mdiff --git a/machines/algedi/configuration.nix b/machines/algedi/configuration.nix[m
[1mindex 9cfccf8..8ebf181 100644[m
[1m--- a/machines/algedi/configuration.nix[m
[1m+++ b/machines/algedi/configuration.nix[m
[36m@@ -57,6 +57,11 @@[m
     htop[m
   ];[m
   programs.vim.defaultEditor = true;[m
[32m+[m[41m [m
[32m+[m[32m  security.acme = {[m
[32m+[m[32m    email = "sinavir@sinavir.fr";[m
[32m+[m[32m    acceptTerms = true;[m
[32m+[m[32m  };[m[41m    [m
 [m
   # Enable the OpenSSH daemon.[m
   services.openssh.enable = true;[m
[1mdiff --git a/machines/algedi/radicale.nix b/machines/algedi/radicale.nix[m
[1mindex 44d6c3c..36bb4b4 100644[m
[1m--- a/machines/algedi/radicale.nix[m
[1m+++ b/machines/algedi/radicale.nix[m
[36m@@ -10,10 +10,10 @@[m
       };[m
     };[m
     rights = {[m
[31m-      rentree = {[m
[31m-        user = ".*";[m
[31m-        collection = "rentree";[m
[31m-        permissions = "i";[m
[32m+[m[32m      root = {[m
[32m+[m[32m        user = ".+";[m
[32m+[m[32m        collection = "";[m
[32m+[m[32m        permissions = "R";[m
       };[m
       principal = {[m
         user = ".+";[m
[36m@@ -25,6 +25,11 @@[m
         collection = "{user}/[^/]+";[m
         permissions = "rw";[m
       };[m
[32m+[m[32m      rentree = {[m
[32m+[m[32m        user = ".*";[m
[32m+[m[32m        collection = "rentree/[^/]+";[m
[32m+[m[32m        permissions = "i";[m
[32m+[m[32m      };[m
     };[m
   };[m
   services.nginx = {[m
[36m@@ -35,12 +40,12 @@[m
       locations = {[m
         "/radicale/" = {[m
           proxyPass = "http://localhost:5232/";[m
[31m-          extraConfig = """[m
[32m+[m[32m          extraConfig = ''[m
             proxy_set_header  X-Script-Name /radicale;[m
             proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;[m
[31m-            proxy_set_header  Host $http_host;[m
[32m+[m[32m            proxy_set_header  Host $host;[m
             proxy_pass_header Authorization;[m
[31m-          """;[m
[32m+[m[32m          '';[m
         };[m
       };[m
     };[m
[1mdiff --git a/shared/secrets/default.nix b/shared/secrets/default.nix[m
[1mindex 1a360f3..97d0edc 100644[m
[1m--- a/shared/secrets/default.nix[m
[1m+++ b/shared/secrets/default.nix[m
[36m@@ -9,7 +9,7 @@[m
 [m
   age.secrets = lib.mkMerge [[m
     (lib.mkIf (config.networking.hostName == "polaris") {"wg-polaris".file = ./wg-polaris.age;})[m
[31m-    (lib.mkIf (config.networking.hostName == "polaris") {"radicale-htpasswd" = {[m
[32m+[m[32m    (lib.mkIf (config.networking.hostName == "algedi") {"radicale-htpasswd" = {[m
       file = ./radicale-htpasswd.age;[m
       owner = "radicale";[m
       group = "radicale";[m
[1mdiff --git a/shared/secrets/radicale-htpasswd.age b/shared/secrets/radicale-htpasswd.age[m
[1mindex 8368c3a..5ef26a0 100644[m
[1m--- a/shared/secrets/radicale-htpasswd.age[m
[1m+++ b/shared/secrets/radicale-htpasswd.age[m
[36m@@ -1,12 +1,11 @@[m
 age-encryption.org/v1[m
[31m--> ssh-ed25519 JGx7Ng sLuChOfQEwuKrH8TSrvpzg4MKj0TJFRiNRxcbxyRz30[m
[31m-fAxDDFFTBIXDoGWP3Y9PxRuSkcqPFUgM+y70aiEcTO0[m
[31m--> ssh-ed25519 kXobKQ G/doqrw/COplqqeNcF40D0WxE1CpG3dUSaDAZjgLyC4[m
[31m-nv1hK1z/KtPuCqQQaU3lHmA0ptFYJeH/e/WfpW106SQ[m
[31m--> ssh-ed25519 PIvCDg dEx6NcC+QQfvTfHS7NaH6t3D9EZzok+65YOfS4rFTUY[m
[31m-UQhWYi1METrODm5MnSHBSnByofRJMUJ1Wb7a2Cfc41Y[m
[31m--> S84,c,-grease |4DOYl0[m
[31m-0j0TP2TVhDZqwgcVraReNhV6+STTts2WoLeDn5pqnq82NjZTdTzBLuLfIOb93k4j[m
[31m-hseiJp5I8YTx9+qnv+Ietsq0g5MA2K56q6Wft88PwM8[m
[31m---- yprMhhFnG+sOqroetEGMboLQwhhUVahbI8Ds1orgfus[m
[31m--hḱ\3.JoZOY4?ng.f0ES	g]1EҜ(ԅ2]Xժf0QB(>dL[m
\ No newline at end of file[m
[32m+[m[32m-> ssh-ed25519 JGx7Ng qL3PPdvfmyQ00FxXN2bWFVGzLMqmSBFVjLSzpWDlEw0[m
[32m+[m[32mwttWMhQF5VX6S2sNz0cbxcDtEodZiuWyqqnXLfGhMz8[m
[32m+[m[32m-> ssh-ed25519 kXobKQ c8TuwXc1+Su9Vns9v9N104Zg86VRuimgnwH2l6lzgXE[m
[32m+[m[32m8bq+qx340sOLbSm62OZ+Dgj1mgWTL1fV3AXDsK/fviU[m
[32m+[m[32m-> ssh-ed25519 PIvCDg CjVE7vzDVqhvB/ZGBDwQw2n3YFtKhLL1QBfn5iJPuE0[m
[32m+[m[32mVBcX+Kdn9bp/TEjWYuoa10VPAupFhWXoqTlT2AW9hsA[m
[32m+[m[32m-> ?ee*-grease[m
[32m+[m[32mR14TKq2UcbWNcF1IoRHZdpz4ZrcCwsXzlQyd7LA[m
[32m+[m[32m--- 37Y+VZKboe/68jE2aahQBNUUgwVlWFJ5qEt4DxbzTxE[m
[32m+[m[32mࡦ:ƔS]95i}rZ?TE$VL$TǜCj!Şこ zბc4q9[m
\ No newline at end of file[m
